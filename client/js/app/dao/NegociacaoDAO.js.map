{"version":3,"file":"NegociacaoDAO.js","names":["Negociacao","_modelsNegociacaoJs","execute","_store","WeakMap","_connection","_export","NegociacaoDAO","connection","_classCallCheck","_classPrivateFieldInitSpec","writable","value","_classPrivateFieldSet","_createClass","key","adiciona","negociacao","_this","Promise","resolve","reject","request","_classPrivateFieldGet","transaction","objectStore","add","toJSON","onsuccess","onerror","e","console","error","target","listaTodos","_this2","cursor","openCursor","negociacoes","atual","result","data","quantidade","valor","push","name","apagarTodos","_this3","clear"],"sources":["../../app-es6/dao/NegociacaoDAO.js"],"sourcesContent":["import { Negociacao } from '../models/Negociacao.js';\n\nexport class NegociacaoDAO {\n  #store = 'negociacoes';\n  #connection;\n  constructor(connection) {\n    this.#connection = connection;\n  }\n\n  adiciona(negociacao) {\n    return new Promise((resolve, reject) => {\n      const request = this.#connection\n        .transaction([this.#store], 'readwrite')\n        .objectStore(this.#store)\n        .add(negociacao.toJSON());\n\n      request.onsuccess = () => {\n        resolve();\n      };\n\n      request.onerror = (e) => {\n        console.error(e.target.error);\n        reject('Não foi possível adicionar negociação');\n      };\n    });\n  }\n\n  listaTodos() {\n    return new Promise((resolve, reject) => {\n      const cursor = this.#connection\n        .transaction([this.#store], 'readonly')\n        .objectStore(this.#store)\n        .openCursor();\n\n      const negociacoes = [];\n      cursor.onsuccess = (e) => {\n        const atual = e.target.result;\n        if (atual) {\n          const negociacao = new Negociacao(\n            atual.value.data,\n            atual.value.quantidade,\n            atual.value.valor,\n          );\n          negociacoes.push(negociacao);\n          atual.continue();\n        } else {\n          resolve(negociacoes);\n        }\n      };\n\n      cursor.onerror = (e) => {\n        console.error(e.target.error.name);\n        reject('Não foi possível carregar as negociações');\n      };\n    });\n  }\n\n  apagarTodos() {\n    return new Promise((resolve, reject) => {\n      const request = this.#connection\n        .transaction([this.#store], 'readwrite')\n        .objectStore(this.#store)\n        .clear();\n\n      request.onsuccess = () => {\n        resolve();\n      };\n\n      request.onerror = (e) => {\n        console.error(e.target.error);\n        reject('Não foi possível apagar as negociações');\n      };\n    });\n  }\n}\n"],"mappings":"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"}